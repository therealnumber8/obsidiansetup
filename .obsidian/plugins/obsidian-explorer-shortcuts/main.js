/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/
var Ee=Object.create;var I=Object.defineProperty;var xe=Object.getOwnPropertyDescriptor;var ve=Object.getOwnPropertyNames;var ge=Object.getPrototypeOf,we=Object.prototype.hasOwnProperty;var ye=(e,o)=>{for(var t in o)I(e,t,{get:o[t],enumerable:!0})},B=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of ve(o))!we.call(e,n)&&n!==t&&I(e,n,{get:()=>o[n],enumerable:!(r=xe(o,n))||r.enumerable});return e};var H=(e,o,t)=>(t=e!=null?Ee(ge(e)):{},B(o||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),Fe=e=>B(I({},"__esModule",{value:!0}),e);var qe={};ye(qe,{default:()=>P});module.exports=Fe(qe);var me=require("obsidian");var K={focusNeeded:!0,delConfirmFile:!1,delConfirmFolder:!0};var y=require("obsidian"),b=class extends y.PluginSettingTab{constructor(t,r){super(t,r);this.plugin=r;this.plugin=r}display(){let{containerEl:t}=this;t.empty(),new y.Setting(t).setName("Confirm before deleting files").addToggle(r=>r.setValue(this.plugin.settings.delConfirmFile).onChange(async n=>{this.plugin.settings.delConfirmFile=n,await this.plugin.saveSettings()})),new y.Setting(t).setName("Confirm before deleting folders").addToggle(r=>r.setValue(this.plugin.settings.delConfirmFolder).onChange(async n=>{this.plugin.settings.delConfirmFolder=n,await this.plugin.saveSettings()}))}};var E=H(require("path"));function f(e){var o,t,r;return(r=(t=(o=e==null?void 0:e.children[0])==null?void 0:o.getAttribute("data-path"))!=null?t:e==null?void 0:e.getAttribute("data-path"))!=null?r:""}function m(e){return e.explorerfileContainer||e.explorerfolderContainer||null}function $(e,o){return e.mousePosition={x:o.clientX,y:o.clientY},e.mousePosition?document.elementFromPoint(e.mousePosition.x,e.mousePosition.y):null}function N(e,o){var t;return(t=e==null?void 0:e.classList.contains(o))!=null?t:!1}var q=e=>N(e,"nav-file"),A=e=>N(e,"is-collapsed"),j=e=>N(e,"nav-folder"),W=e=>{var o,t;return(t=(o=e.elementFromPoint)==null?void 0:o.closest(".nav-file"))!=null?t:null},X=e=>{var o,t;return(t=(o=e.elementFromPoint)==null?void 0:o.closest(".nav-folder"))!=null?t:null};function S(){return document.querySelectorAll(".nav-files-container .nav-file, .nav-files-container .nav-folder")}async function D(e){return new Promise(o=>{setTimeout(()=>{let t=Ie(e);if(!t)return o();t.scrollIntoView({behavior:"smooth",block:"center"}),o()},100)})}function x(e){var t;let o=(t=Y(e))==null?void 0:t.view;return!o||!o.fileItems?[]:Object.entries(o.fileItems)||[]}function G(e){var t;return(t=x(e).find(r=>r[1].selfEl.classList.contains("is-active")))!=null?t:null}function O(e,o){let t=f(o),r=x(e);if(r){for(let n of r)if(n[0].includes(t)){n[1].setCollapsed(!1,!0);break}}}var F=e=>{var t;return((t=e.elementFromPoint)==null?void 0:t.closest(".workspace-leaf-content[data-type='file-explorer'] .nav-files-container"))||null};function Y(e){var t,r;let{workspace:o}=e.app;return(r=(t=o.getLeavesOfType("file-explorer"))==null?void 0:t.first())!=null?r:null}function v(e){let o=Y(e);return o?o.view:null}function Ie(e){var t;let o=v(e);return(t=o==null?void 0:o.containerEl.querySelector(".is-active"))!=null?t:null}function _(e){return{dir:E.dirname(e),name:E.basename(e,E.extname(e)),ext:E.extname(e)}}function z(e,o){e.operation=o;let t=m(e);if(!t)return;let r=o==="cut"?"copy":"cut";t.classList.contains(r)&&t.classList.remove(r),t.classList.toggle(o)}function J(e){z(e,"copy")}function Q(e){z(e,"cut")}function Z(e){S().forEach(t=>{t.classList.remove("copy","cut")}),e.operation=null}var h=require("obsidian");var g=require("obsidian"),R=class extends g.Modal{constructor(t,r,n){super(t);this.message=r;this.callback=n;this.scope=new g.Scope(this.scope),this.scope.register([],"Enter",()=>{this.confirm(!0)})}confirm(t){this.callback(t),this.close()}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("p").setText(this.message),new g.Setting(this.contentEl).addButton(r=>{r.setIcon("checkmark").setCta().onClick(()=>this.confirm(!0))}).addExtraButton(r=>r.setIcon("cross").onClick(()=>this.confirm(!1)))}onClose(){let{contentEl:t}=this;t.empty()}};async function be(e,o){return await new Promise(t=>{new R(e,o,r=>{t(r)}).open()})}async function ee(e){return await be(this.app,e)}function te(e){let o=["Up/Down Arrow: Navigate between files and folders","Left Arrow: Toggle collapse/expand all folders","Right Arrow: Reveal the active file","F2 or R: Rename the selected file/folder","N: Create a new file","F: Create a new folder","X: Cut the selected file/folder","C: Copy the selected file/folder","Esc: Cancel all operations","V: Paste the cut or copied file/folder","Delete: Delete the selected file/folder","W: Open the hovered file in a new window","Shift + ?: Show this modal"],t=new g.Modal(e);t.titleEl.textContent="Explorer shortcuts reminder",t.contentEl.innerHTML=o.map(r=>`<p>${r}</p>`).join(""),t.open()}async function re(e,o){let t=!0,r=v(e),n=r==null?void 0:r.tree;if(!n)return;let i=m(e),s=f(i)||"/",l=r.fileItems[s];if(!l)return;let c=l.file;if(c instanceof h.TFile&&l.el.children[0].classList.contains("has-focus")||(e.settings.delConfirmFile&&c instanceof h.TFile?t=await oe(c):e.settings.delConfirmFolder&&c instanceof h.TFolder&&(t=await oe(c)),!t))return;n.selectItem(l),n.handleDeleteSelectedItems(o);let p=c instanceof h.TFile?"File":"Folder";new h.Notice(`${p} removed: `+c.name,3500)}async function oe(e){return ee(" Are you sure you want to delete "+e.name+"?")}function ne(e,o){let t=new MouseEvent("mousemove",{clientX:e.mousePosition.x+1,clientY:e.mousePosition.y+1});setTimeout(()=>{document.dispatchEvent(t)},70)}var ie=require("obsidian");async function M(e,o="down"){await Se(e);let t=Ce(e,o);if(!t){new ie.Notice("End of list",800);return}q(t)&&await Ne(e,t)}async function Se(e){let o=G(e);if(!o)return;let[t,r]=o;for(let n=0;n<2;n++){let i=x(e);for(let[s,l]of i)t.startsWith(s)&&A(l.el)&&l.setCollapsed(!1,!1);await new Promise(s=>setTimeout(s,50))}await D(e)}function Ce(e,o){let t=C();if(t.length===0)return;let r=ke(t);if(r===-1){if(r=Te(e,t),r===-1)return;t=C()}return Le(e,t,r,o)}function Te(e,o){let t=x(e),r=e.app.workspace.getLeaf(!1);if(!(r!=null&&r.view.file))return-1;let n=r.view.file.path,i=t.find(l=>l[0]===n);return i?(O(e,i[1].el),C().findIndex(l=>l.children[0].classList.contains("is-active"))):-1}function C(){let e=S();return Array.from(e).filter(o=>!o.children[0].classList.contains("is-unsupported")&&!o.classList.contains("mod-root"))}function ke(e){return e.findIndex(o=>o.children[0].classList.contains("is-active"))}function T(e,o,t){return t==="down"?(e+1)%o:(e-1+o)%o}function Le(e,o,t,r){let n=o,i=T(t,n.length,r),s=n[i];for(;j(s);){if(A(s)){let{newIndex:l,newList:c}=Pe(e,s,n,i,r);i=l,n=c}else i=T(i,n.length,r);s=n[i]}return s}function Pe(e,o,t,r,n){let i=t.length;O(e,o);let s=C(),c=s.length-i,p=s.indexOf(o),u;return n==="down"?u=c===0?T(r,s.length,n):p+1:u=c===0?T(r,s.length,n):p+c,{newIndex:u,newList:s}}async function Ne(e,o){let t=f(o);if(!t)return;let r=e.app.vault.getFileByPath(t);if(!r)return;let n=e.app.workspace.getLeaf(!1);n&&(await n.openFile(r),await D(e))}var k=require("obsidian");async function V(e,o){let t=v(e);if(!t)return;let r=m(e),n=f(r)||"/",i;if(n==="/")i=e.app.vault.getRoot();else{let l=t.fileItems[n].file;l instanceof k.TFile?i=l.parent||e.app.vault.getRoot():l instanceof k.TFolder?i=l:i=e.app.vault.getRoot()}t.createAbstractFile(o,i,!0)}var a=require("obsidian"),d=H(require("path"));var L=!1;async function se(e){var n;let t=x(e).filter(i=>i[1].el.classList.contains("copy")||i[1].el.classList.contains("cut"));if(!t.length){new a.Notice("No items selected for paste operation");return}let r=(n=Ve(e))!=null?n:"/";try{L=!1;let i=await Ae(e,t,r);for(let s of t){let l=s[0],c=d.join(r,d.basename(l)),p=s[1].el.classList.contains("copy")?"copy":"cut",u=!1;if(i.includes(l))if(L)u=!0;else{let w=await De(e.app,d.basename(l),i.length);if(w==="cancel")continue;u=w==="replace"}await Oe(e,s,c,p,u)}}catch(i){console.error("Paste operation failed:",i),new a.Notice("Paste operation failed. Check console for details.")}}async function Ae(e,o,t){let r=[];for(let n of o){let i=d.join(t,d.basename(n[0]));await e.app.vault.adapter.exists(i)&&r.push(n[0])}return r}async function De(e,o,t){return new Promise(r=>{let n=new a.Modal(e);n.titleEl.textContent=`File "${o}" already exists`,new a.Setting(n.contentEl).setName("Choose Action").addDropdown(i=>{i.addOption("increment","Increment name").addOption("replace","Replace existing").setValue("increment").onChange(s=>{r(s),n.close()})}),t>1&&new a.Setting(n.contentEl).setName("Apply to all remaining files").addToggle(i=>{i.setValue(L).onChange(s=>{L=s})}),new a.Setting(n.contentEl).addButton(i=>{i.setButtonText("Cancel").onClick(()=>{r("cancel"),n.close()})}),n.open()})}async function Oe(e,o,t,r,n){let i=o[0];if((0,a.normalizePath)(i)===(0,a.normalizePath)(t)){new a.Notice("Cannot paste to the same location",2e3);return}n||(t=Ue(e,o[1].file instanceof a.TFile?"file":"folder",t));try{r==="copy"?await Re(e,o,t,n):await Me(e,o,t,n),o[1].el.classList.remove(r)}catch(s){console.error(`Failed to ${r} item:`,s),new a.Notice(`Failed to ${r} item. Check console for details.`)}}async function Re(e,o,t,r){if(o[1].file instanceof a.TFile)if(r){let n=await e.app.vault.adapter.read(o[1].file.path);await e.app.vault.adapter.write(t,n)}else await e.app.vault.copy(o[1].file,t);else o[1].file instanceof a.TFolder&&await le(e,o[1].file,t,r)}async function le(e,o,t,r){r&&await e.app.vault.adapter.rmdir(t,!0),await e.app.vault.createFolder(t);for(let n of o.children){let i=(0,a.normalizePath)(d.join(t,n.name));n instanceof a.TFile?await e.app.vault.copy(n,i):n instanceof a.TFolder&&await le(e,n,i,r)}}async function Me(e,o,t,r){o[1].file instanceof a.TFile?(r&&await e.app.vault.adapter.remove(t),await e.app.fileManager.renameFile(o[1].file,t)):await e.app.vault.rename(o[1].file,t)}function Ve(e,o=!1){let t=m(e);if(!t)return;let r=f(t);return d.extname(r)?d.dirname(r):r}function Ue(e,o,t){let{dir:r,name:n,ext:i}=_(t),s=r==="."?"":r+"/",l=n||"Untitled",c=o==="file"?i||".md":"",p=-1,u=l,w=(0,a.normalizePath)(s+u+c),de=/^(Untitled)(\s*(\d+))?$/,he=l.match(de);for(;e.app.vault.getAbstractFileByPath(w);)p++,he?u=p===0?"Untitled":`Untitled ${p}`:u=p===0?l:`${l} (${p})`,w=(0,a.normalizePath)(s+u+c);return w}async function ae(e,o){let t=v(e);if(!t)return;let r=m(e);if(!r)return;let n=t.tree;if(!n)return;let i=f(r)||"/",s=t.fileItems[i];if(!s)return;n.setFocusedItem(s),n.handleRenameFocusedItem(o);let l=t.containerEl.querySelector('[contenteditable="true"]');l&&(l.onblur=function(){var c;e.renaming=!1,(c=r.firstElementChild)==null||c.classList.remove("has-focus")})}var Be=50;function ce(){let e=document.querySelector('.nav-action-button[aria-label="Collapse all"]'),o=document.querySelector('.nav-action-button[aria-label="Expand all"]'),t=e||o;if(t){let r=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(r)}else console.warn("Toggle collapse/expand button not found")}function fe(e){try{e.app.commands.executeCommandById("file-explorer:reveal-active-file"),e.app.commands.executeCommandById("file-explorer:reveal-active-file"),setTimeout(()=>{let o=e.app.workspace.getLeaf(!1);o?e.app.workspace.setActiveLeaf(o,{focus:!0}):console.warn("No active leaf found")},Be)}catch(o){console.error("Failed to reveal active file:",o)}}var U=!1;async function pe(e){var t,r,n;if(!U||!F(this))return;if(((t=this.elementFromPoint)==null?void 0:t.closest(".is-being-renamed"))&&this.blockedKeys[e.key]&&delete this.blockedKeys[e.key],e.key==="Escape"&&Z(this),this.renaming){this.blockedKeys={};return}if(e.key==="ArrowLeft"&&ce(),e.key==="ArrowRight"&&fe(this),!!((r=this.elementFromPoint)!=null&&r.closest(".nav-files-container"))&&(e.key==="ArrowUp"&&await M(this,"up"),e.key==="ArrowDown"&&await M(this,"down"),e.key==="n"&&await V(this,"file"),e.key==="f"&&await V(this,"folder"),!!((n=this.elementFromPoint)!=null&&n.closest(".tree-item")))){if((e.key==="r"||e.key==="F2")&&(this.renaming=!0,await ae(this,e)),e.key==="x"&&Q(this),e.key==="c"&&J(this),e.key==="v"&&await se(this),e.key==="Delete"&&(await re(this,e),ne(this,e)),e.key==="w"){let i=m(this);await Ke(this,i)}e.key==="h"&&te(this.app)}}function ue(e){if(F(this)&&!this.renaming)if(He(e.key))e.preventDefault(),this.blockedKeys[e.key]=!0,U=!0;else{U=!1;return}}function He(e){return["n","r","x","c","q","v","d","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","f","F2","Escape","Delete","w","h"].includes(e)}async function Ke(e,o){let t=f(o);if(!t)return;let r=e.app.vault.getFileByPath(t);if(!r)return;let n=e.app.workspace.getLeaf("window");n&&await n.openFile(r)}var P=class extends me.Plugin{constructor(){super(...arguments);this.elementFromPoint=null;this.explorerfileContainer=null;this.explorerfolderContainer=null;this.renaming=!1;this.blockedKeys={};this.operation=null}async onload(){await this.loadSettings(),this.addSettingTab(new b(this.app,this)),this.app.workspace.onLayoutReady(this.onLayoutReady.bind(this))}onLayoutReady(){this.registerDomEvents()}registerDomEvents(){this.registerDomEvent(document,"mousemove",$e.bind(this)),this.registerDomEvent(document,"keydown",ue.bind(this),!0),this.registerDomEvent(document,"keyup",async t=>await pe.call(this,t))}async loadSettings(){this.settings=Object.assign({},K,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};function $e(e){this.elementFromPoint=$(this,e),F(this)&&(this.explorerfolderContainer=X(this),this.explorerfileContainer=W(this))}
